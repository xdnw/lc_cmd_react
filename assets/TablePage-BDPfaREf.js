import{r as j,c as de,j as s,R as be}from"./index-Ci-lVsFi.js";import{d as ge,B as re,g as Ce}from"./button-CWqPuK0O.js";import{g as ye,D as ie,a as ve,b as je,c as we,d as Se,e as ke}from"./table_util-BA5kOBg_.js";import{c as Ne,l as Te}from"./index.module-Cm1UP7MU.js";import{Y as pe,C as Ae}from"./CommandComponent-CIm2wK6D.js";import{C as ue,t as me}from"./command-utils-BU29VnaS.js";import{u as De,b as $e,c as Oe,d as Fe,T as he,B as xe}from"./DialogContext-ByDpcWnk.js";import{I as fe}from"./input-QGQmWr9A.js";import{a as ae}from"./StateUtil-BG53k1sy.js";import{L as ce}from"./queries-l4D1Q0nU.js";import{A as Me}from"./AbstractTable-BTJfMiFM.js";import"./command-meta-J_rOZp3J.js";import"./SimpleChart-B07JoOv1.js";import"./dropdown-menu-DLcaEqVB.js";import"./theme-provider-CM04Ee5i.js";import"./bulkwrapper-CcS8ktbB.js";import"./useSuspenseQuery-C2wurJin.js";import"./DataTable-BVQz3GBY.js";const Re=j.forwardRef(function(e,n){const t=de.c(45),{defType:l,defSelection:o,defColumns:c,defSort:a}=e,{showDialog:h}=De(),[d,g]=ae(l),[r,A]=ae(o),[p,D]=j.useState(c),[N,k]=ae(a);let $,F;t[0]!==p||t[1]!==r||t[2]!==N||t[3]!==d?($=()=>({getType:()=>d,getSelection:()=>r,getColumns:()=>p,getSort:()=>N}),F=[d,r,p,N],t[0]=p,t[1]=r,t[2]=N,t[3]=d,t[4]=$,t[5]=F):($=t[4],F=t[5]),j.useImperativeHandle(n,$,F);let B,x;t[6]===Symbol.for("react.memo_cache_sentinel")?(x=ue.getPlaceholderTypes(!1),t[6]=x):x=t[6],B=x;const y=B;let w;t[7]!==p||t[8]!==r||t[9]!==N||t[10]!==d?(w=()=>{const W=ye({type:d,selAndModifiers:r,columns:p,sort:N}),Y=window.location.hash,[_]=Y.split("?"),U=`${_}?${W}`;window.history.replaceState(null,"",`${window.location.pathname}${U}`)},t[7]=p,t[8]=r,t[9]=N,t[10]=d,t[11]=w):w=t[11];const T=w;let M;t[12]!==T?(M=()=>{T()},t[12]=T,t[13]=M):M=t[13];let m;t[14]!==p||t[15]!==r||t[16]!==T||t[17]!==N||t[18]!==d?(m=[d,r,p,N,T],t[14]=p,t[15]=r,t[16]=T,t[17]=N,t[18]=d,t[19]=m):m=t[19],j.useEffect(M,m);let C;t[20]!==A||t[21]!==k||t[22]!==g?(C=W=>{const Y=W;g(Y);const _=ie[Y]?.selections,U=ie[Y]?.columns;if(_&&Object.keys(_).length>0&&A({"":_[Object.keys(_)[0]]}),U&&Object.keys(U).length>0){const V=U[Object.keys(U)[0]];D(new Map(V.value.map(Ge))),k(i=>ge(i,V.sort)?i:V.sort)}},t[20]=A,t[21]=k,t[22]=g,t[23]=C):C=t[23];const O=C;let R;t[24]===Symbol.for("react.memo_cache_sentinel")?(R=W=>s.jsx(Oe,{value:y[W],className:"w-auto px-3",children:me(y[W])},y[W]),t[24]=R):R=t[24];const X=R;let se,Q;t[25]===Symbol.for("react.memo_cache_sentinel")?(Q={overflow:"hidden"},t[25]=Q):Q=t[25];let L;t[26]===Symbol.for("react.memo_cache_sentinel")?(L=s.jsx($e,{className:"min-w-full min-h-0 h-8.5 rounded-lg border border-border bg-card p-0",style:Q,children:s.jsx(pe,{totalCount:y.length,style:{height:"100%",width:"100%"},horizontalDirection:!0,itemContent:X})}),t[26]=L):L=t[26],se=L;const H=se;let P,z;t[27]===Symbol.for("react.memo_cache_sentinel")?(z=s.jsx("div",{className:"w-full overflow-x-auto",children:H}),t[27]=z):z=t[27];let K;t[28]!==l||t[29]!==O?(K=s.jsx(Fe,{defaultValue:l,className:"w-full",onValueChange:O,children:z}),t[28]=l,t[29]=O,t[30]=K):K=t[30],P=K;const q=P;let oe,G;t[31]!==r||t[32]!==A||t[33]!==d?(G=s.jsx(Ke,{type:d,selection:r,setSelection:A,selectedTab:d}),t[31]=r,t[32]=A,t[33]=d,t[34]=G):G=t[34],oe=G;const I=oe;let ne,Z;t[35]!==p||t[36]!==k||t[37]!==h||t[38]!==N||t[39]!==d?(Z=s.jsx(Ee,{type:d,columns:p,setColumns:D,sort:N,setSort:k,showDialog:h}),t[35]=p,t[36]=k,t[37]=h,t[38]=N,t[39]=d,t[40]=Z):Z=t[40],ne=Z;const le=ne;let J;return t[41]!==le||t[42]!==I||t[43]!==q?(J=s.jsxs(s.Fragment,{children:[q,I,le]}),t[41]=le,t[42]=I,t[43]=q,t[44]=J):J=t[44],J});function Ee(f){const e=de.c(74),{type:n,columns:t,setColumns:l,sort:o,setSort:c,showDialog:a}=f,[h,d]=j.useState(!1);let g;e[0]!==n?(g=Object.keys(ie[n]?.columns??{}),e[0]=n,e[1]=g):g=e[1];const[r,A]=ae(g);let p,D;e[2]!==A||e[3]!==n?(p=()=>{A(Object.keys(ie[n]?.columns??{}))},D=[n,A],e[2]=A,e[3]=n,e[4]=p,e[5]=D):(p=e[4],D=e[5]),j.useEffect(p,D);const N=j.useRef(null),k=j.useRef(null);let $;e[6]!==t||e[7]!==l||e[8]!==c||e[9]!==o?($=(i,u)=>{const S=Array.from(t);if(u<0||u>=S.length)return;const[E]=S.splice(i,1);S.splice(u,0,E);const v=new Map(S);let ee;if(Array.isArray(o))ee=o.map(b=>b.idx===i?{...b,idx:u}:b.idx===u?{...b,idx:i}:b.idx>i&&b.idx<=u?{...b,idx:b.idx-1}:b.idx<i&&b.idx>=u?{...b,idx:b.idx+1}:b);else if(o){const b={...o};b.idx===i?b.idx=u:b.idx===u?b.idx=i:b.idx>i&&b.idx<=u?b.idx=b.idx-1:b.idx<i&&b.idx>=u&&(b.idx=b.idx+1),ee=b}else ee=void 0;l(v),c(ee)},e[6]=t,e[7]=l,e[8]=c,e[9]=o,e[10]=$):$=e[10];const F=$;let B;e[11]===Symbol.for("react.memo_cache_sentinel")?(B=i=>{i.preventDefault();const S=i.clipboardData.getData("text").replace(/\r?\n|\r/g,"	");if(k.current){const{selectionStart:E,selectionEnd:v,value:ee}=k.current,b=ee.slice(0,E)+S+ee.slice(v);k.current.value=b}},e[11]=B):B=e[11];const x=B;let y;e[12]!==t||e[13]!==l?(y=i=>{if(i.key.length===1||i.key==="Backspace"){const u=document.activeElement,S=u.id.startsWith("btn-")?u.id.split("-")[1]:"";if(!S)return;const E=u.querySelector("span"),v=i.key,ee=t.get(S)||"",b=new Map(t);if(v==="Backspace"){const te=ee.slice(0,-1);b.set(S,te||null),E.firstChild.textContent=te.trim()?` as ${te}`:"​"}else{i.key===" "&&i.preventDefault();const te=ee.trim()+v;b.set(S,te),E.firstChild.textContent=` as ${te}`}l(b)}},e[12]=t,e[13]=l,e[14]=y):y=e[14];const w=y;let T,M;e[15]!==w?(T=()=>(document.addEventListener("keydown",w),()=>{document.removeEventListener("keydown",w)}),M=[w],e[15]=w,e[16]=T,e[17]=M):(T=e[16],M=e[17]),j.useEffect(T,M);let m;e[18]!==t||e[19]!==l||e[20]!==a?(m=()=>{const i=k.current;if(!i)return;const u=i.value;if(u===""){a("Column name cannot be empty","Please enter a column name before adding");return}const S=u.split("	"),E=[],v=new Map(t);for(const ee of S){if(ee==="")continue;const b=ee.split(";");if(!b[0])continue;let te=b[0];if(!te.includes("{")&&!te.includes("}")&&(te="{"+te+"}"),v.has(te)&&v.get(te)===(b[1]??null)){E.push("Column `"+ee+"` is already added");continue}v.set(te,b[1]||null)}i.value="",E.length>0&&a("Errors adding columns",E.join(`
`)),l(v)},e[18]=t,e[19]=l,e[20]=a,e[21]=m):m=e[21];const C=m;let O;e[22]!==l||e[23]!==c||e[24]!==n?(O=i=>{const u=ie[n]?.columns[i],S=new Map((u?.value||["{id}"]).map(Ve)),E=u?.sort||{idx:0,dir:"asc"};l(S),c(E)},e[22]=l,e[23]=c,e[24]=n,e[25]=O):O=e[25];const R=O;let X;e[26]!==t||e[27]!==l||e[28]!==c||e[29]!==o?(X=(i,u)=>{const S=new Map(t);S.delete(i[0]);let E;if(Array.isArray(o))E=o.filter(v=>v.idx!==u).map(v=>({...v,idx:v.idx>u?v.idx-1:v.idx}));else if(o){const v={...o};v.idx===u?v.idx=0:v.idx>u&&(v.idx=v.idx-1),E=v}else E=void 0;l(S),c(E)},e[26]=t,e[27]=l,e[28]=c,e[29]=o,e[30]=X):X=e[30];const se=X;let Q;e[31]!==c||e[32]!==o?(Q=(i,u)=>{let S;if(Array.isArray(o)){const E=o.findIndex(v=>v.idx===i);if(E!==-1){const v=[...o];v[E].dir==="asc"?v[E].dir="desc":v.splice(E,1),S=v}else u&&o.length>0?S=[...o,{idx:i,dir:"asc"}]:S={idx:i,dir:"asc"}}else o?o.idx!==i?u&&o.idx!==0?S=[{idx:o.idx,dir:o.dir},{idx:i,dir:"asc"}]:S={idx:i,dir:"asc"}:o.dir==="asc"?S={idx:i,dir:"desc"}:S=void 0:S={idx:i,dir:"asc"};c(S)},e[31]=c,e[32]=o,e[33]=Q):Q=e[33];const L=Q;let H;e[34]!==l||e[35]!==c?(H=()=>{l(new Map),c({idx:0,dir:"asc"})},e[34]=l,e[35]=c,e[36]=H):H=e[36];const P=H;let z;e[37]!==t||e[38]!==l?(z=i=>{const u="{"+i[0]+"}",S=new Map(t);S.set(u,null),l(S)},e[37]=t,e[38]=l,e[39]=z):z=e[39];const K=z;let q;e[40]===Symbol.for("react.memo_cache_sentinel")?(q=()=>{d(ze)},e[40]=q):q=e[40];const oe=q;let G;e[41]!==R?(G=i=>{const u=i.currentTarget.dataset.key;u&&R(u)},e[41]=R,e[42]=G):G=e[42];const I=G;let ne;e[43]!==h?(ne=s.jsxs(re,{variant:"ghost",size:"sm",className:"text-xs font-semibold w-full border-b border-border px-2 bg-muted/40 rounded-none justify-start",onClick:oe,children:["Columns ",h?s.jsx(ce,{name:"ChevronDown"}):s.jsx(ce,{name:"ChevronUp"})]}),e[43]=h,e[44]=ne):ne=e[44];const Z=`transition-all duration-200 ease-in-out ${h?"max-h-0 opacity-0 overflow-hidden":"px-2 py-1.5 opacity-100 space-y-1.5"}`;let le;e[45]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsx("h2",{className:"text-sm font-semibold mb-0.5",children:"Templates"}),e[45]=le):le=e[45];let J;if(e[46]!==I||e[47]!==r){let i;e[49]!==I?(i=u=>s.jsx(re,{variant:"outline",size:"sm",className:"me-1","data-key":u,onClick:I,children:u},u),e[49]=I,e[50]=i):i=e[50],J=r.map(i),e[46]=I,e[47]=r,e[48]=J}else J=e[48];let W;e[51]!==P||e[52]!==t||e[53]!==L||e[54]!==F||e[55]!==se||e[56]!==o?(W=s.jsx(_e,{columns:t,sort:o,moveColumn:F,removeColumn:se,handleColumnSort:L,clearAllColumns:P}),e[51]=P,e[52]=t,e[53]=L,e[54]=F,e[55]=se,e[56]=o,e[57]=W):W=e[57];let Y;e[58]!==C||e[59]!==n?(Y=s.jsx(Pe,{colInputRef:k,addButton:N,handlePaste:x,handleAddColumn:C,type:n}),e[58]=C,e[59]=n,e[60]=Y):Y=e[60];let _;e[61]!==K||e[62]!==t||e[63]!==n?(_=s.jsx(He,{type:n,columns:t,addSimpleColumn:K}),e[61]=K,e[62]=t,e[63]=n,e[64]=_):_=e[64];let U;e[65]!==Z||e[66]!==J||e[67]!==W||e[68]!==Y||e[69]!==_?(U=s.jsxs("div",{className:Z,children:[le,J,W,Y,_]}),e[65]=Z,e[66]=J,e[67]=W,e[68]=Y,e[69]=_,e[70]=U):U=e[70];let V;return e[71]!==ne||e[72]!==U?(V=s.jsxs("div",{className:"themeDiv mt-1.5 overflow-hidden",children:[ne,U]}),e[71]=ne,e[72]=U,e[73]=V):V=e[73],V}function ze(f){return!f}function Ve(f){return Array.isArray(f)?[f[0],f[1]]:[f,null]}function _e(f){const e=de.c(28),{columns:n,sort:t,moveColumn:l,removeColumn:o,handleColumnSort:c,clearAllColumns:a}=f,h=Le;let d;e[0]!==c?(d=m=>{if(m.button===1){const C=parseInt(m.currentTarget.dataset.key||"0",10);return m.preventDefault(),c(C,m.shiftKey),!1}},e[0]=c,e[1]=d):d=e[1];const g=d;let r;e[2]!==n?(r=()=>Array.from(n).map(Be).join(`
`),e[2]=n,e[3]=r):r=e[3];const A=r;let p;e[4]!==l?(p=m=>{const C=parseInt(m.currentTarget.dataset.from??"0",10),O=parseInt(m.currentTarget.dataset.to??"0",10);m.preventDefault(),C!==O&&l(C,O)},e[4]=l,e[5]=p):p=e[5];const D=p;let N;e[6]!==n||e[7]!==o?(N=m=>{const C=parseInt(m.currentTarget.dataset.key??"0",10),O=m.currentTarget.dataset.column,R=[O,n.get(O)??null];m.preventDefault(),o(R,C)},e[6]=n,e[7]=o,e[8]=N):N=e[8];const k=N;let $,F,B;e[9]===Symbol.for("react.memo_cache_sentinel")?($=s.jsx("h2",{className:"text-sm font-semibold mt-0.5 pb-0 mb-0",children:"Current Columns"}),F=s.jsx("span",{className:"text-[10px] opacity-50 leading-tight",children:"left-click to remove | middle-click to sort | shift+middle to sort by multiple | right click and type/backspace to edit alias | clipboard button to copy"}),B=s.jsx("br",{}),e[9]=$,e[10]=F,e[11]=B):($=e[9],F=e[10],B=e[11]);let x;e[12]!==n?(x=Array.from(n),e[12]=n,e[13]=x):x=e[13];let y;e[14]!==D||e[15]!==k||e[16]!==t||e[17]!==x||e[18]!==g?(y=x.map((m,C)=>s.jsxs("span",{className:"inline-flex items-center bg-background rounded me-1 mb-1",children:[s.jsx(ce,{name:"ChevronLeft",className:"cursor-pointer w-4 h-6 rounded-s hover:bg-accent","data-from":C,"data-to":C-1,onClick:D}),s.jsxs(re,{"data-key":C,id:"btn-"+m[0],variant:"outline",size:"sm",className:"rounded-none border-r-input/50 border-l-input/50 inline-block",onContextMenu:h,"data-column":m[0],"data-index":C,onClick:k,onMouseDown:g,children:[m[0],s.jsx("span",{className:"text-xs opacity-50",children:m[1]&&m[1]!==m[0]?` as ${m[1]}`:"​"},`colspan-${C}`),t&&(Array.isArray(t)?t.map((O,R)=>O.idx===C&&s.jsxs("span",{className:"bg-red-400 dark:bg-red-900 text-xs ml-1",children:[O.dir," (",R+1,")"]},`sort-${C}-${R}`)):t.idx===C&&s.jsx("span",{className:"bg-red-400 dark:bg-red-900 text-xs ml-1",children:t.dir},`sort-${C}`))]},m[0]),s.jsx(ce,{name:"ChevronRight",className:"cursor-pointer inline-block w-4 rounded-e hover:bg-accent align-middle","data-from":C,"data-to":C+1,onClick:D})]},`spw-${C}`)),e[14]=D,e[15]=k,e[16]=t,e[17]=x,e[18]=g,e[19]=y):y=e[19];let w;e[20]!==A?(w=s.jsx(he,{children:s.jsx(xe,{getText:A,className:"rounded [&_svg]:size-3.5 me-1",size:"sm"})}),e[20]=A,e[21]=w):w=e[21];let T;e[22]!==a?(T=s.jsx(re,{variant:"destructive",size:"sm",className:"rounded",onClick:a,children:"X"}),e[22]=a,e[23]=T):T=e[23];let M;return e[24]!==w||e[25]!==T||e[26]!==y?(M=s.jsxs(s.Fragment,{children:[$,F,B,s.jsxs("div",{className:"inline-flex flex-wrap items-center gap-1",children:[y,w,T]})]}),e[24]=w,e[25]=T,e[26]=y,e[27]=M):M=e[27],M}function Be(f){const[e,n]=f;return n?`${e};${n}`:e}function Le(f){f.preventDefault(),f.currentTarget.focus()}function Pe(f){const e=de.c(28),{colInputRef:n,addButton:t,handleAddColumn:l,handlePaste:o,type:c}=f,[a,h]=j.useState(""),d=j.useRef(a);let g,r;e[0]!==a?(g=()=>{d.current=a},r=[a],e[0]=a,e[1]=g,e[2]=r):(g=e[1],r=e[2]),j.useEffect(g,r);let A;e[3]!==n||e[4]!==l?(A=z=>{if(z.key==="Enter")z.preventDefault(),d.current&&(l(),h(""));else if(z.key==="Tab"){z.preventDefault();const K=n.current;if(K){const q=K.selectionStart,oe=K.selectionEnd;if(q!==null&&oe!==null){const G=d.current,I=G.slice(0,q)+"	"+G.slice(oe);h(I),setTimeout(()=>{K.setSelectionRange(q+1,q+1)},0)}}}},e[3]=n,e[4]=l,e[5]=A):A=e[5];const p=A;let D;e[6]===Symbol.for("react.memo_cache_sentinel")?(D=z=>{h(z.target.value)},e[6]=D):D=e[6];const N=D;let k,$;e[7]===Symbol.for("react.memo_cache_sentinel")?($=s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"text-sm font-semibold mt-0.5 mb-0 p-0",children:"Add Custom"}),s.jsx("span",{className:"text-[10px] opacity-50 leading-tight",children:"type or paste in the placeholder, then press Enter | Use tab for multiple | Use semicolon ;BLAH for column alias"})]}),e[7]=$):$=e[7],k=$;const F=k;let B,x;e[8]!==n||e[9]!==o||e[10]!==a||e[11]!==p?(x=s.jsx(fe,{type:"text",className:"relative px-1 grow",placeholder:"Custom column placeholders...",ref:n,onPaste:o,onKeyDown:p,onChange:N,value:a}),e[8]=n,e[9]=o,e[10]=a,e[11]=p,e[12]=x):x=e[12],B=x;const y=B;let w;e[13]!==l||e[14]!==a?(w=()=>{a&&(l(),h(""))},e[13]=l,e[14]=a,e[15]=w):w=e[15];const T=w;let M,m;e[16]!==t||e[17]!==T?(m=s.jsx(re,{variant:"destructive",ref:t,size:"sm",className:"ml-2",onClick:T,children:"Add"}),e[16]=t,e[17]=T,e[18]=m):m=e[18],M=m;const C=M;let O,R;e[19]!==C||e[20]!==y?(R=s.jsxs("div",{className:"flex w-full",children:[y,C]}),e[19]=C,e[20]=y,e[21]=R):R=e[21],O=R;const X=O;let se;const Q=`https://github.com/xdnw/locutus/wiki/${c}_placeholders`;let L;e[22]!==Q||e[23]!==c?(L=s.jsxs("a",{href:Q,className:"text-xs text-blue-800 dark:text-blue-400 underline hover:no-underline active:underline",target:"_blank",rel:"noreferrer",children:["View All ",c," Placeholders"]}),e[22]=Q,e[23]=c,e[24]=L):L=e[24],se=L;const H=se;let P;return e[25]!==H||e[26]!==X?(P=s.jsxs(s.Fragment,{children:[F,X,H]}),e[25]=H,e[26]=X,e[27]=P):P=e[27],P}const Ue=be.memo(f=>{const e=de.c(9),{option:n,isHidden:t,onClick:l}=f;if(t)return null;let o;e[0]!==l||e[1]!==n?(o=()=>{l(n)},e[0]=l,e[1]=n,e[2]=o):o=e[2];const c=o;let a;e[3]!==n[1]?(a=s.jsx("span",{className:"text-xs opacity-50",children:n[1]}),e[3]=n[1],e[4]=a):a=e[4];let h;return e[5]!==c||e[6]!==n[0]||e[7]!==a?(h=s.jsxs(re,{variant:"outline",size:"sm",className:"me-1 mb-1",onClick:c,children:[n[0],": ",a]}),e[5]=c,e[6]=n[0],e[7]=a,e[8]=h):h=e[8],h});function He({type:f,columns:e,addSimpleColumn:n}){const[t,l]=j.useState(!0),o=j.useRef(null),[c,a]=j.useState(""),[h]=Te(c,150),d=j.useRef(null),g=j.useMemo(()=>t?[]:ve(f),[f,t]),r=j.useMemo(()=>g.filter(([x,y])=>!h||x.toLowerCase().includes(h.toLowerCase())||y.toLowerCase().includes(h.toLowerCase())),[g,h]),[A,p]=j.useState(0);j.useEffect(()=>{if(!t&&d.current){const x=new ResizeObserver(y=>{const{width:w}=y[0].contentRect;p(w)});return x.observe(d.current),()=>x.disconnect()}},[t]);const D=j.useCallback(x=>n(x),[n]),N=15,k=j.useMemo(()=>{const x=[];for(let y=0;y<r.length;y+=N)x.push(r.slice(y,y+N));return x},[r]),$=j.useCallback(x=>{a(x.target.value.toLowerCase())},[]),F=j.useCallback(()=>{l(x=>!x)},[l]),B=j.useCallback(x=>{const y=k[x];return s.jsx("div",{className:"flex flex-wrap",children:y.map((w,T)=>{if(e.has("{"+w[0]+"}"))return null;const m=`${x}-${T}`;return s.jsx(Ue,{option:w,isHidden:!1,onClick:D},m)})})},[k,e,D]);return s.jsxs("div",{className:"mt-1.5 rounded-md border border-border bg-card/60",children:[s.jsxs(re,{variant:"ghost",size:"sm",className:"text-xs font-semibold w-full border-b border-border px-2 bg-muted/40 rounded-none justify-start",onClick:F,children:["Add Simple ",t?s.jsx(ce,{name:"ChevronDown"}):s.jsx(ce,{name:"ChevronUp"})]}),s.jsxs("div",{className:`transition-all duration-200 ease-in-out ${t?"max-h-0 opacity-0 overflow-hidden":"px-2 py-1.5 opacity-100"}`,children:[s.jsx(fe,{ref:o,type:"text",className:"w-full mb-1.5",placeholder:"Filter options",value:c,onChange:$}),s.jsxs("div",{ref:d,className:"w-full",children:[!t&&k.length>0&&s.jsx(pe,{style:{height:Math.min(400,k.length*40)},totalCount:k.length,itemContent:B}),!t&&r.length===0&&s.jsx("div",{className:"py-2 text-center text-muted-foreground",children:"No matching options found"})]}),r.length>100&&s.jsxs("div",{className:"text-center text-xs text-muted-foreground",children:["Showing all ",r.length," options"]})]})]})}function Ke(f){const e=de.c(50),{type:n,selection:t,setSelection:l}=f,[o,c]=j.useState(!1),[a,h]=j.useState(t[""]);let d,g;e[0]!==n?(g=Object.keys(ie[n]?.selections??{}),e[0]=n,e[1]=g):g=e[1],d=g;const r=d;let A,p;e[2]!==t?(A=()=>{h(V=>V!==t[""]?t[""]:V)},p=[t,h],e[2]=t,e[3]=A,e[4]=p):(A=e[3],p=e[4]),j.useEffect(A,p);let D;e[5]!==t||e[6]!==l?(D=V=>{l({...t,"":V})},e[5]=t,e[6]=l,e[7]=D):D=e[7];const N=Ne(D,150);let k;e[8]!==N?(k=V=>{const i=V.target.value;h(i),N(i)},e[8]=N,e[9]=k):k=e[9];const $=k;let F;e[10]===Symbol.for("react.memo_cache_sentinel")?(F=()=>{c(We)},e[10]=F):F=e[10];const B=F;let x,y;e[11]!==o?(y=s.jsxs(re,{variant:"ghost",size:"sm",className:"text-xs font-semibold w-full border-b border-border px-2 bg-muted/40 rounded-none justify-start",onClick:B,children:["Selection ",o?s.jsx(ce,{name:"ChevronDown"}):s.jsx(ce,{name:"ChevronUp"})]}),e[11]=o,e[12]=y):y=e[12],x=y;const w=x;let T;e[13]!==t||e[14]!==l||e[15]!==n?(T=V=>{const i=V.currentTarget.dataset.key;if(!i)return;const u=ie[n]?.selections[i]||"*";h(u),l({...t,"":u})},e[13]=t,e[14]=l,e[15]=n,e[16]=T):T=e[16];const M=T;let m,C;e[17]===Symbol.for("react.memo_cache_sentinel")?(C=s.jsx("h2",{className:"text-sm font-semibold mb-0.5",children:"Templates"}),e[17]=C):C=e[17];let O;e[18]!==r||e[19]!==M?(O=s.jsxs(s.Fragment,{children:[C,r.map(V=>s.jsx(re,{variant:"outline",size:"sm",className:"me-1","data-key":V,onClick:M,children:V},V))]}),e[18]=r,e[19]=M,e[20]=O):O=e[20],m=O;const R=m;let X;e[21]!==a?(X=()=>a,e[21]=a,e[22]=X):X=e[22];const se=X;let Q,L;e[23]===Symbol.for("react.memo_cache_sentinel")?(L=s.jsx("h2",{className:"text-sm font-semibold mt-0.5",children:"Current Selection"}),e[23]=L):L=e[23];let H;e[24]!==$||e[25]!==a?(H=s.jsx(fe,{className:"relative px-1 w-full",type:"text",value:a,onChange:$}),e[24]=$,e[25]=a,e[26]=H):H=e[26];let P;e[27]!==se?(P=s.jsx(he,{children:s.jsx(xe,{getText:se,className:"rounded [&_svg]:size-3 static",size:"sm"})}),e[27]=se,e[28]=P):P=e[28];let z;e[29]!==H||e[30]!==P?(z=s.jsxs(s.Fragment,{children:[L,s.jsxs("div",{className:"flex items-center gap-1",children:[H,P]})]}),e[29]=H,e[30]=P,e[31]=z):z=e[31],Q=z;const K=Q;let q,oe;e[32]!==t||e[33]!==l||e[34]!==n?(oe=ue.placeholders(n).getCreate()&&s.jsx(Qe,{modifier:ue.placeholders(n).getCreate(),selection:t,setSelection:l}),e[32]=t,e[33]=l,e[34]=n,e[35]=oe):oe=e[35],q=oe;const G=q;let I;const ne=`https://github.com/xdnw/locutus/wiki/${me(n)}_placeholders`;let Z;e[36]!==n?(Z=me(n),e[36]=n,e[37]=Z):Z=e[37];let le;e[38]!==ne||e[39]!==Z?(le=s.jsxs("a",{href:ne,className:"text-xs text-blue-800 dark:text-blue-400 underline hover:no-underline active:underline",target:"_blank",rel:"noreferrer",children:["View All ",Z," Filters"]}),e[38]=ne,e[39]=Z,e[40]=le):le=e[40],I=le;const J=I;let W;W=`transition-all duration-200 ease-in-out ${o?"max-h-0 opacity-0 overflow-hidden":"px-2 py-1.5 opacity-100 space-y-1.5"}`;const Y=W;let _;e[41]!==Y||e[42]!==J||e[43]!==K||e[44]!==G||e[45]!==R?(_=s.jsxs("div",{className:Y,children:[R,K,G,J]}),e[41]=Y,e[42]=J,e[43]=K,e[44]=G,e[45]=R,e[46]=_):_=e[46];let U;return e[47]!==w||e[48]!==_?(U=s.jsxs("div",{className:"themeDiv mt-1.5 overflow-hidden",children:[w,_]}),e[47]=w,e[48]=_,e[49]=U):U=e[49],U}function We(f){return!f}function Qe(f){const e=de.c(7),{modifier:n,selection:t,setSelection:l}=f;let o;e[0]!==t||e[1]!==l?(o=(d,g)=>{if(g){if(t[d]===g)return;l({...t,[d]:g})}else{if(t[d]===void 0)return;const r={...t};delete r[d],l(r)}},e[0]=t,e[1]=l,e[2]=o):o=e[2];const c=o,a=qe;let h;return e[3]!==n||e[4]!==t||e[5]!==c?(h=s.jsx(Ae,{overrideName:"Modifier",command:n,filterArguments:a,initialValues:t,setOutput:c}),e[3]=n,e[4]=t,e[5]=c,e[6]=h):h=e[6],h}function qe(){return!0}function Ge(f){return Array.isArray(f)?[f[0],f[1]]:[f,null]}function ft(){const f=j.useMemo(()=>Ce(),[]),[e]=ae(je(f)??"DBNation"),[n]=ae(we(f,e)),[t]=ae((function(){const g=ie[e],r=Object.keys(g?.columns??{})[0],A=r?g?.columns[r]?.value:void 0;return Se(f)??new Map((A??["{id}"]).map(p=>Array.isArray(p)?[p[0],p[1]]:[p,null]))})()),l=ie[e],o=Object.keys(l?.columns??{})[0],[c]=ae(ke(f)??(o?l?.columns[o]?.sort:void 0)),a=j.useRef(null),h=j.useCallback(()=>{const g=a.current;return{type:g?.getType()??e,selection:g?.getSelection()??n,columns:g?.getColumns()??t,sort:g?.getSort()??c}},[a,e,n,t,c]),d=j.useMemo(()=>s.jsx("div",{className:"themeDiv p-2 mt-2",children:s.jsx(Me,{getTableProps:h,load:!1})}),[h]);return s.jsxs(s.Fragment,{children:[s.jsx(Re,{ref:a,defType:e,defSelection:n,defColumns:t,defSort:c}),d]})}export{ft as default};
