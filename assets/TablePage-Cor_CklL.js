import{r as u,c as ne,j as n,R as pe}from"./index-nW9DkA3u.js";import{d as xe,B as G,g as he}from"./button-ujMD_D3S.js";import{D as I,g as be,r as ge,a as ve,b as Ce,c as ye,d as je,e as ke,f as we}from"./table_util-BhRzU9Kk.js";import{c as Se,l as Ne}from"./index.module-Cn541vrP.js";import{Y as ue,A as Te}from"./ArgInput-tGvOpFqN.js";import{C as ie,t as re,g as Ae}from"./command-utils-CoW9iswN.js";import{u as Oe,b as $e,c as Re,d as Ve,T as me,B as fe}from"./DialogContext-BfwqmJEN.js";import{C as Ee}from"./CommandComponent-DHq1-Tfc.js";import{I as ce}from"./input-VVMxW7J4.js";import{a as ee}from"./StateUtil-BU5RTinU.js";import{L as te}from"./queries-B0bYDAFD.js";import{A as Fe}from"./AbstractTable-BnDE7RfY.js";import"./command-meta-Dd5nXUBW.js";import"./MathUtil-8RZlDOhB.js";import"./bulkwrapper-CgTU9lyN.js";import"./useSuspenseQuery--1Q7REA5.js";import"./SimpleChart-BZ5w6o67.js";import"./dropdown-menu-6Z3pQS9A.js";import"./theme-provider-BEuElyuX.js";import"./DataTable-CrC93K72.js";const De=u.forwardRef(function(e,l){const t=ne.c(49),{defType:o,defSelection:m,defColumns:d,defSort:b}=e,{showDialog:f,hideDialog:w}=Oe(),[p,h]=ee(o),[C,S]=ee(m),[y,O]=u.useState(d),[N,A]=ee(b);let $;t[0]!==o?($=()=>{const L=Object.keys(I[o]?.columns??{})[0];return L?I[o]?.columns[L]?.columnRenderers:void 0},t[0]=o,t[1]=$):$=t[1];const[D,g]=u.useState($);let v,T;t[2]!==D||t[3]!==y||t[4]!==C||t[5]!==N||t[6]!==p?(v=()=>({getType:()=>p,getSelection:()=>C,getColumns:()=>y,getSort:()=>N,getColumnRenderers:()=>D}),T=[p,C,y,N,D],t[2]=D,t[3]=y,t[4]=C,t[5]=N,t[6]=p,t[7]=v,t[8]=T):(v=t[7],T=t[8]),u.useImperativeHandle(l,v,T);let R,E;t[9]===Symbol.for("react.memo_cache_sentinel")?(E=ie.getPlaceholderTypes(!1),t[9]=E):E=t[9],R=E;const j=R;let s;t[10]!==y||t[11]!==C||t[12]!==N||t[13]!==p?(s=()=>{const L=be({type:p,selAndModifiers:C,columns:y,sort:N}),q=window.location.hash,[Z]=q.split("?"),le=`${Z}?${L}`;window.history.replaceState(null,"",`${window.location.pathname}${le}`)},t[10]=y,t[11]=C,t[12]=N,t[13]=p,t[14]=s):s=t[14];const a=s;let i;t[15]!==a?(i=()=>{a()},t[15]=a,t[16]=i):i=t[16];let k;t[17]!==y||t[18]!==C||t[19]!==a||t[20]!==N||t[21]!==p?(k=[p,C,y,N,a],t[17]=y,t[18]=C,t[19]=a,t[20]=N,t[21]=p,t[22]=k):k=t[22],u.useEffect(i,k);let x;t[23]!==S||t[24]!==A||t[25]!==h?(x=L=>{const q=L;h(q);const Z=I[q]?.selections,le=I[q]?.columns;if(Z&&Object.keys(Z).length>0&&S({"":Z[Object.keys(Z)[0]]}),le&&Object.keys(le).length>0){const oe=le[Object.keys(le)[0]];O(new Map(oe.value.map(Ye))),A(de=>xe(de,oe.sort)?de:oe.sort),g(oe.columnRenderers)}},t[23]=S,t[24]=A,t[25]=h,t[26]=x):x=t[26];const F=x;let r;t[27]===Symbol.for("react.memo_cache_sentinel")?(r=L=>n.jsx(Re,{value:j[L],className:"w-auto px-3",children:re(j[L])},j[L]),t[27]=r):r=t[27];const V=r;let U,P;t[28]===Symbol.for("react.memo_cache_sentinel")?(P={overflow:"hidden"},t[28]=P):P=t[28];let M;t[29]===Symbol.for("react.memo_cache_sentinel")?(M=n.jsx($e,{className:"min-w-full min-h-0 h-8.5 rounded-lg border border-border bg-card p-0",style:P,children:n.jsx(ue,{totalCount:j.length,style:{height:"100%",width:"100%"},horizontalDirection:!0,itemContent:V})}),t[29]=M):M=t[29],U=M;const z=U;let H,B;t[30]===Symbol.for("react.memo_cache_sentinel")?(B=n.jsx("div",{className:"w-full overflow-x-auto",children:z}),t[30]=B):B=t[30];let _;t[31]!==o||t[32]!==F?(_=n.jsx(Ve,{defaultValue:o,className:"w-full",onValueChange:F,children:B}),t[31]=o,t[32]=F,t[33]=_):_=t[33],H=_;const K=H;let W,Y;t[34]!==C||t[35]!==S||t[36]!==p?(Y=n.jsx(He,{type:p,selection:C,setSelection:S,selectedTab:p}),t[34]=C,t[35]=S,t[36]=p,t[37]=Y):Y=t[37],W=Y;const se=W;let ae,J;t[38]!==y||t[39]!==w||t[40]!==A||t[41]!==f||t[42]!==N||t[43]!==p?(J=n.jsx(Le,{type:p,columns:y,setColumns:O,sort:N,setSort:A,setColumnRenderers:g,showDialog:f,hideDialog:w}),t[38]=y,t[39]=w,t[40]=A,t[41]=f,t[42]=N,t[43]=p,t[44]=J):J=t[44],ae=J;const Q=ae;let X;return t[45]!==Q||t[46]!==se||t[47]!==K?(X=n.jsxs(n.Fragment,{children:[K,se,Q]}),t[45]=Q,t[46]=se,t[47]=K,t[48]=X):X=t[48],X});function Le({type:c,columns:e,setColumns:l,sort:t,setSort:o,setColumnRenderers:m,showDialog:d,hideDialog:b}){const[f,w]=u.useState(!1),[p,h]=ee(Object.keys(I[c]?.columns??{}));u.useEffect(()=>{h(Object.keys(I[c]?.columns??{}))},[c,h]);const C=u.useRef(null),S=u.useRef(null),y=u.useCallback((s,a)=>{const i=Array.from(e);if(a<0||a>=i.length)return;const[k]=i.splice(s,1);i.splice(a,0,k);const x=new Map(i);let F;if(Array.isArray(t))F=t.map(r=>r.idx===s?{...r,idx:a}:r.idx===a?{...r,idx:s}:r.idx>s&&r.idx<=a?{...r,idx:r.idx-1}:r.idx<s&&r.idx>=a?{...r,idx:r.idx+1}:r);else if(t){const r={...t};r.idx===s?r.idx=a:r.idx===a?r.idx=s:r.idx>s&&r.idx<=a?r.idx=r.idx-1:r.idx<s&&r.idx>=a&&(r.idx=r.idx+1),F=r}else F=void 0;l(x),o(F),m(void 0)},[e,t,l,o]),O=u.useCallback(s=>{if(s.key.length===1||s.key==="Backspace"){const a=document.activeElement,i=a.id.startsWith("btn-")?a.id.split("-")[1]:"";if(!i)return;const k=a.querySelector("span"),x=s.key,F=e.get(i)||"",r=new Map(e);if(x==="Backspace"){const V=F.slice(0,-1);r.set(i,V||null),k.firstChild.textContent=V.trim()?` as ${V}`:"​"}else{s.key===" "&&s.preventDefault();const V=F.trim()+x;r.set(i,V),k.firstChild.textContent=` as ${V}`}l(r)}},[e,l]);u.useEffect(()=>(document.addEventListener("keydown",O),()=>{document.removeEventListener("keydown",O)}),[O]);const N=u.useCallback(()=>{const s=S.current;if(!s)return;const a=s.value;if(a===""){d("Column name cannot be empty","Please enter a column name before adding");return}const i=a.split("	"),k=[],x=new Map(e);for(const F of i){if(F==="")continue;const r=F.split(";");if(!r[0])continue;let V=r[0];if(!V.includes("{")&&!V.includes("}")&&(V="{"+V+"}"),x.has(V)&&x.get(V)===(r[1]??null)){k.push("Column `"+F+"` is already added");continue}x.set(V,r[1]||null)}s.value="",k.length>0&&d("Errors adding columns",k.join(`
`)),l(x),m(void 0)},[e,d,l]),A=u.useCallback((s,a)=>{const i=ge(c,s,a)??I[c]?.columns[s];if(!i){d("Template not found",`Could not find column template "${s}" for ${c}.`);return}const k=new Map((i?.value||["{id}"]).map(F=>Array.isArray(F)?[F[0],F[1]]:[F,null])),x=i?.sort||{idx:0,dir:"asc"};l(k),o(x),m(i.columnRenderers)},[c,l,o,m,d]),$=u.useCallback((s,a)=>{try{A(s,a),b()}catch(i){const k=i instanceof Error?i.message:String(i);d("Layout configuration error",k)}},[A,b,d]),D=u.useCallback(s=>{const a=ve(c,s);if(!a){A(s);return}d(`Configure ${s}`,n.jsx(Ie,{templateName:s,config:a,onApplyTemplate:$}))},[c,A,d,$]),g=u.useCallback((s,a)=>{const i=new Map(e);i.delete(s[0]);let k=t;if(Array.isArray(t))k=t.filter(x=>x.idx!==a).map(x=>({...x,idx:x.idx>a?x.idx-1:x.idx}));else if(t){const x={...t};x.idx===a?x.idx=0:x.idx>a&&(x.idx=x.idx-1),k=x}else k=void 0;l(i),o(k),m(void 0)},[e,t,l,o]),v=u.useCallback((s,a)=>{let i;if(Array.isArray(t)){const k=t.findIndex(x=>x.idx===s);if(k!==-1){const x=[...t];x[k].dir==="asc"?x[k].dir="desc":x.splice(k,1),i=x}else a&&t.length>0?i=[...t,{idx:s,dir:"asc"}]:i={idx:s,dir:"asc"}}else t?t.idx!==s?a&&t.idx!==0?i=[{idx:t.idx,dir:t.dir},{idx:s,dir:"asc"}]:i={idx:s,dir:"asc"}:t.dir==="asc"?i={idx:s,dir:"desc"}:i=void 0:i={idx:s,dir:"asc"};o(i)},[t,o]),T=u.useCallback(()=>{l(new Map),o({idx:0,dir:"asc"}),m(void 0)},[l,o,m]),R=u.useCallback(s=>{const a="{"+s[0]+"}",i=new Map(e);i.set(a,null),l(i),m(void 0)},[e,l,m]),E=u.useCallback(()=>{w(s=>!s)},[w]),j=u.useCallback(s=>{const a=s.currentTarget.dataset.key;a&&D(a)},[D]);return n.jsxs("div",{className:"themeDiv mt-1.5 overflow-hidden",children:[n.jsxs(G,{variant:"ghost",size:"sm",className:"text-xs font-semibold w-full border-b border-border px-2 bg-muted/40 rounded-none justify-start",onClick:E,children:["Columns ",f?n.jsx(te,{name:"ChevronDown"}):n.jsx(te,{name:"ChevronUp"})]}),n.jsxs("div",{className:`transition-all duration-200 ease-in-out ${f?"max-h-0 opacity-0 overflow-hidden":"px-2 py-1.5 opacity-100 space-y-1.5"}`,children:[n.jsx("h2",{className:"text-sm font-semibold mb-0.5",children:"Templates"}),p.map(s=>n.jsx(G,{variant:"outline",size:"sm",className:"me-1","data-key":s,onClick:j,children:s},s)),n.jsx(Me,{columns:e,sort:t,moveColumn:y,removeColumn:g,handleColumnSort:v,clearAllColumns:T}),n.jsx(_e,{colInputRef:S,addButton:C,handleAddColumn:N,type:c}),n.jsx(Ue,{type:c,columns:e,addSimpleColumn:R})]})]})}function Me(c){const e=ne.c(28),{columns:l,sort:t,moveColumn:o,removeColumn:m,handleColumnSort:d,clearAllColumns:b}=c,f=Be;let w;e[0]!==d?(w=j=>{if(j.button===1){const s=parseInt(j.currentTarget.dataset.key||"0",10);return j.preventDefault(),d(s,j.shiftKey),!1}},e[0]=d,e[1]=w):w=e[1];const p=w;let h;e[2]!==l?(h=()=>Array.from(l).map(ze).join(`
`),e[2]=l,e[3]=h):h=e[3];const C=h;let S;e[4]!==o?(S=j=>{const s=parseInt(j.currentTarget.dataset.from??"0",10),a=parseInt(j.currentTarget.dataset.to??"0",10);j.preventDefault(),s!==a&&o(s,a)},e[4]=o,e[5]=S):S=e[5];const y=S;let O;e[6]!==l||e[7]!==m?(O=j=>{const s=parseInt(j.currentTarget.dataset.key??"0",10),a=j.currentTarget.dataset.column,i=[a,l.get(a)??null];j.preventDefault(),m(i,s)},e[6]=l,e[7]=m,e[8]=O):O=e[8];const N=O;let A,$,D;e[9]===Symbol.for("react.memo_cache_sentinel")?(A=n.jsx("h2",{className:"text-sm font-semibold mt-0.5 pb-0 mb-0",children:"Current Columns"}),$=n.jsx("span",{className:"text-[10px] opacity-50 leading-tight",children:"left-click to remove | middle-click to sort | shift+middle to sort by multiple | right click and type/backspace to edit alias | clipboard button to copy"}),D=n.jsx("br",{}),e[9]=A,e[10]=$,e[11]=D):(A=e[9],$=e[10],D=e[11]);let g;e[12]!==l?(g=Array.from(l),e[12]=l,e[13]=g):g=e[13];let v;e[14]!==y||e[15]!==N||e[16]!==t||e[17]!==g||e[18]!==p?(v=g.map((j,s)=>n.jsxs("span",{className:"inline-flex items-center bg-background rounded me-1 mb-1",children:[n.jsx(te,{name:"ChevronLeft",className:"cursor-pointer w-4 h-6 rounded-s hover:bg-accent","data-from":s,"data-to":s-1,onClick:y}),n.jsxs(G,{"data-key":s,id:"btn-"+j[0],variant:"outline",size:"sm",className:"rounded-none border-r-input/50 border-l-input/50 inline-block",onContextMenu:f,"data-column":j[0],"data-index":s,onClick:N,onMouseDown:p,children:[j[0],n.jsx("span",{className:"text-xs opacity-50",children:j[1]&&j[1]!==j[0]?` as ${j[1]}`:"​"},`colspan-${s}`),t&&(Array.isArray(t)?t.map((a,i)=>a.idx===s&&n.jsxs("span",{className:"bg-red-400 dark:bg-red-900 text-xs ml-1",children:[a.dir," (",i+1,")"]},`sort-${s}-${i}`)):t.idx===s&&n.jsx("span",{className:"bg-red-400 dark:bg-red-900 text-xs ml-1",children:t.dir},`sort-${s}`))]},j[0]),n.jsx(te,{name:"ChevronRight",className:"cursor-pointer inline-block w-4 rounded-e hover:bg-accent align-middle","data-from":s,"data-to":s+1,onClick:y})]},`spw-${s}`)),e[14]=y,e[15]=N,e[16]=t,e[17]=g,e[18]=p,e[19]=v):v=e[19];let T;e[20]!==C?(T=n.jsx(me,{children:n.jsx(fe,{getText:C,className:"rounded [&_svg]:size-3.5 me-1",size:"sm"})}),e[20]=C,e[21]=T):T=e[21];let R;e[22]!==b?(R=n.jsx(G,{variant:"destructive",size:"sm",className:"rounded",onClick:b,children:"X"}),e[22]=b,e[23]=R):R=e[23];let E;return e[24]!==T||e[25]!==R||e[26]!==v?(E=n.jsxs(n.Fragment,{children:[A,$,D,n.jsxs("div",{className:"inline-flex flex-wrap items-center gap-1",children:[v,T,R]})]}),e[24]=T,e[25]=R,e[26]=v,e[27]=E):E=e[27],E}function ze(c){const[e,l]=c;return l?`${e};${l}`:e}function Be(c){c.preventDefault(),c.currentTarget.focus()}function _e(c){const e=ne.c(28),{colInputRef:l,addButton:t,handleAddColumn:o,type:m}=c,[d,b]=u.useState(""),f=u.useRef(d);let w,p;e[0]!==d?(w=()=>{f.current=d},p=[d],e[0]=d,e[1]=w,e[2]=p):(w=e[1],p=e[2]),u.useEffect(w,p);let h;e[3]!==l||e[4]!==o?(h=M=>{if(M.key==="Enter")M.preventDefault(),f.current&&(o(),b(""));else if(M.key==="Tab"){M.preventDefault();const z=l.current;if(z){const H=z.selectionStart,B=z.selectionEnd;if(H!==null&&B!==null){const _=f.current,K=_.slice(0,H)+"	"+_.slice(B);b(K),setTimeout(()=>{z.setSelectionRange(H+1,H+1)},0)}}}},e[3]=l,e[4]=o,e[5]=h):h=e[5];const C=h;let S;e[6]===Symbol.for("react.memo_cache_sentinel")?(S=M=>{b(M.target.value)},e[6]=S):S=e[6];const y=S;let O;e[7]===Symbol.for("react.memo_cache_sentinel")?(O=M=>{M.preventDefault();const z=M.currentTarget,B=M.clipboardData.getData("text").replace(/\r?\n|\r/g,"	"),_=z.selectionStart??z.value.length,K=z.selectionEnd??_,W=z.value.slice(0,_)+B+z.value.slice(K);b(W),requestAnimationFrame(()=>{z.setSelectionRange(_+B.length,_+B.length)})},e[7]=O):O=e[7];const N=O;let A,$;e[8]===Symbol.for("react.memo_cache_sentinel")?($=n.jsxs(n.Fragment,{children:[n.jsx("h2",{className:"text-sm font-semibold mt-0.5 mb-0 p-0",children:"Add Custom"}),n.jsx("span",{className:"text-[10px] opacity-50 leading-tight",children:"type or paste in the placeholder, then press Enter | Use tab for multiple | Use semicolon ;BLAH for column alias"})]}),e[8]=$):$=e[8],A=$;const D=A;let g,v;e[9]!==l||e[10]!==d||e[11]!==C?(v=n.jsx(ce,{type:"text",className:"relative px-1 grow",placeholder:"Custom column placeholders...",ref:l,onPaste:N,onKeyDown:C,onChange:y,value:d}),e[9]=l,e[10]=d,e[11]=C,e[12]=v):v=e[12],g=v;const T=g;let R;e[13]!==o||e[14]!==d?(R=()=>{d&&(o(),b(""))},e[13]=o,e[14]=d,e[15]=R):R=e[15];const E=R;let j,s;e[16]!==t||e[17]!==E?(s=n.jsx(G,{variant:"destructive",ref:t,size:"sm",className:"ml-2",onClick:E,children:"Add"}),e[16]=t,e[17]=E,e[18]=s):s=e[18],j=s;const a=j;let i,k;e[19]!==a||e[20]!==T?(k=n.jsxs("div",{className:"flex w-full",children:[T,a]}),e[19]=a,e[20]=T,e[21]=k):k=e[21],i=k;const x=i;let F;const r=`https://github.com/xdnw/locutus/wiki/${m}_placeholders`;let V;e[22]!==r||e[23]!==m?(V=n.jsxs("a",{href:r,className:"text-xs text-blue-800 dark:text-blue-400 underline hover:no-underline active:underline",target:"_blank",rel:"noreferrer",children:["View All ",m," Placeholders"]}),e[22]=r,e[23]=m,e[24]=V):V=e[24],F=V;const U=F;let P;return e[25]!==U||e[26]!==x?(P=n.jsxs(n.Fragment,{children:[D,x,U]}),e[25]=U,e[26]=x,e[27]=P):P=e[27],P}const Pe=pe.memo(c=>{const e=ne.c(9),{option:l,isHidden:t,onClick:o}=c;if(t)return null;let m;e[0]!==o||e[1]!==l?(m=()=>{o(l)},e[0]=o,e[1]=l,e[2]=m):m=e[2];const d=m;let b;e[3]!==l[1]?(b=n.jsx("span",{className:"text-xs opacity-50",children:l[1]}),e[3]=l[1],e[4]=b):b=e[4];let f;return e[5]!==d||e[6]!==l[0]||e[7]!==b?(f=n.jsxs(G,{variant:"outline",size:"sm",className:"me-1 mb-1",onClick:d,children:[l[0],": ",b]}),e[5]=d,e[6]=l[0],e[7]=b,e[8]=f):f=e[8],f});function Ue({type:c,columns:e,addSimpleColumn:l}){const[t,o]=u.useState(!0),m=u.useRef(null),[d,b]=u.useState(""),[f]=Ne(d,150),w=u.useRef(null),p=u.useMemo(()=>t?[]:Ce(c),[c,t]),h=u.useMemo(()=>p.filter(([g,v])=>!f||g.toLowerCase().includes(f.toLowerCase())||v.toLowerCase().includes(f.toLowerCase())),[p,f]),[C,S]=u.useState(0);u.useEffect(()=>{if(!t&&w.current){const g=new ResizeObserver(v=>{const{width:T}=v[0].contentRect;S(T)});return g.observe(w.current),()=>g.disconnect()}},[t]);const y=u.useCallback(g=>l(g),[l]),O=15,N=u.useMemo(()=>{const g=[];for(let v=0;v<h.length;v+=O)g.push(h.slice(v,v+O));return g},[h]),A=u.useCallback(g=>{b(g.target.value.toLowerCase())},[]),$=u.useCallback(()=>{o(g=>!g)},[o]),D=u.useCallback(g=>{const v=N[g];return n.jsx("div",{className:"flex flex-wrap",children:v.map((T,R)=>{if(e.has("{"+T[0]+"}"))return null;const j=`${g}-${R}`;return n.jsx(Pe,{option:T,isHidden:!1,onClick:y},j)})})},[N,e,y]);return n.jsxs("div",{className:"mt-1.5 rounded-md border border-border bg-card/60",children:[n.jsxs(G,{variant:"ghost",size:"sm",className:"text-xs font-semibold w-full border-b border-border px-2 bg-muted/40 rounded-none justify-start",onClick:$,children:["Add Simple ",t?n.jsx(te,{name:"ChevronDown"}):n.jsx(te,{name:"ChevronUp"})]}),n.jsxs("div",{className:`transition-all duration-200 ease-in-out ${t?"max-h-0 opacity-0 overflow-hidden":"px-2 py-1.5 opacity-100"}`,children:[n.jsx(ce,{ref:m,type:"text",className:"w-full mb-1.5",placeholder:"Filter options",value:d,onChange:A}),n.jsxs("div",{ref:w,className:"w-full",children:[!t&&N.length>0&&n.jsx(ue,{style:{height:Math.min(400,N.length*40)},totalCount:N.length,itemContent:D}),!t&&h.length===0&&n.jsx("div",{className:"py-2 text-center text-muted-foreground",children:"No matching options found"})]}),h.length>100&&n.jsxs("div",{className:"text-center text-xs text-muted-foreground",children:["Showing all ",h.length," options"]})]})]})}function He(c){const e=ne.c(50),{type:l,selection:t,setSelection:o}=c,[m,d]=u.useState(!1),[b,f]=u.useState(t[""]);let w,p;e[0]!==l?(p=Object.keys(I[l]?.selections??{}),e[0]=l,e[1]=p):p=e[1],w=p;const h=w;let C,S;e[2]!==t?(C=()=>{f(L=>L!==t[""]?t[""]:L)},S=[t,f],e[2]=t,e[3]=C,e[4]=S):(C=e[3],S=e[4]),u.useEffect(C,S);let y;e[5]!==t||e[6]!==o?(y=L=>{o({...t,"":L})},e[5]=t,e[6]=o,e[7]=y):y=e[7];const O=Se(y,150);let N;e[8]!==O?(N=L=>{const q=L.target.value;f(q),O(q)},e[8]=O,e[9]=N):N=e[9];const A=N;let $;e[10]===Symbol.for("react.memo_cache_sentinel")?($=()=>{d(Ke)},e[10]=$):$=e[10];const D=$;let g,v;e[11]!==m?(v=n.jsxs(G,{variant:"ghost",size:"sm",className:"text-xs font-semibold w-full border-b border-border px-2 bg-muted/40 rounded-none justify-start",onClick:D,children:["Selection ",m?n.jsx(te,{name:"ChevronDown"}):n.jsx(te,{name:"ChevronUp"})]}),e[11]=m,e[12]=v):v=e[12],g=v;const T=g;let R;e[13]!==t||e[14]!==o||e[15]!==l?(R=L=>{const q=L.currentTarget.dataset.key;if(!q)return;const Z=I[l]?.selections[q]||"*";f(Z),o({...t,"":Z})},e[13]=t,e[14]=o,e[15]=l,e[16]=R):R=e[16];const E=R;let j,s;e[17]===Symbol.for("react.memo_cache_sentinel")?(s=n.jsx("h2",{className:"text-sm font-semibold mb-0.5",children:"Templates"}),e[17]=s):s=e[17];let a;e[18]!==h||e[19]!==E?(a=n.jsxs(n.Fragment,{children:[s,h.map(L=>n.jsx(G,{variant:"outline",size:"sm",className:"me-1","data-key":L,onClick:E,children:L},L))]}),e[18]=h,e[19]=E,e[20]=a):a=e[20],j=a;const i=j;let k;e[21]!==b?(k=()=>b,e[21]=b,e[22]=k):k=e[22];const x=k;let F,r;e[23]===Symbol.for("react.memo_cache_sentinel")?(r=n.jsx("h2",{className:"text-sm font-semibold mt-0.5",children:"Current Selection"}),e[23]=r):r=e[23];let V;e[24]!==A||e[25]!==b?(V=n.jsx(ce,{className:"relative px-1 w-full",type:"text",value:b,onChange:A}),e[24]=A,e[25]=b,e[26]=V):V=e[26];let U;e[27]!==x?(U=n.jsx(me,{children:n.jsx(fe,{getText:x,className:"rounded [&_svg]:size-3",size:"sm"})}),e[27]=x,e[28]=U):U=e[28];let P;e[29]!==V||e[30]!==U?(P=n.jsxs(n.Fragment,{children:[r,n.jsxs("div",{className:"flex items-center gap-1",children:[V,U]})]}),e[29]=V,e[30]=U,e[31]=P):P=e[31],F=P;const M=F;let z,H;e[32]!==t||e[33]!==o||e[34]!==l?(H=ie.placeholders(l).getCreate()&&n.jsx(We,{modifier:ie.placeholders(l).getCreate(),selection:t,setSelection:o}),e[32]=t,e[33]=o,e[34]=l,e[35]=H):H=e[35],z=H;const B=z;let _;const K=`https://github.com/xdnw/locutus/wiki/${re(l)}_placeholders`;let W;e[36]!==l?(W=re(l),e[36]=l,e[37]=W):W=e[37];let Y;e[38]!==K||e[39]!==W?(Y=n.jsxs("a",{href:K,className:"text-xs text-blue-800 dark:text-blue-400 underline hover:no-underline active:underline",target:"_blank",rel:"noreferrer",children:["View All ",W," Filters"]}),e[38]=K,e[39]=W,e[40]=Y):Y=e[40],_=Y;const se=_;let ae;ae=`transition-all duration-200 ease-in-out ${m?"max-h-0 opacity-0 overflow-hidden":"px-2 py-1.5 opacity-100 space-y-1.5"}`;const J=ae;let Q;e[41]!==J||e[42]!==se||e[43]!==M||e[44]!==B||e[45]!==i?(Q=n.jsxs("div",{className:J,children:[i,M,B,se]}),e[41]=J,e[42]=se,e[43]=M,e[44]=B,e[45]=i,e[46]=Q):Q=e[46];let X;return e[47]!==T||e[48]!==Q?(X=n.jsxs("div",{className:"themeDiv mt-1.5 overflow-hidden",children:[T,Q]}),e[47]=T,e[48]=Q,e[49]=X):X=e[49],X}function Ke(c){return!c}function We(c){const e=ne.c(7),{modifier:l,selection:t,setSelection:o}=c;let m;e[0]!==t||e[1]!==o?(m=(w,p)=>{if(p){if(t[w]===p)return;o({...t,[w]:p})}else{if(t[w]===void 0)return;const h={...t};delete h[w],o(h)}},e[0]=t,e[1]=o,e[2]=m):m=e[2];const d=m,b=qe;let f;return e[3]!==l||e[4]!==t||e[5]!==d?(f=n.jsx(Ee,{overrideName:"Modifier",command:l,filterArguments:b,initialValues:t,setOutput:d}),e[3]=l,e[4]=t,e[5]=d,e[6]=f):f=e[6],f}function qe(){return!0}function Ie(c){const e=ne.c(31),{templateName:l,config:t,onApplyTemplate:o}=c;let m,d;e[0]!==t.variables?(d=Object.fromEntries(Object.entries(t.variables).map(Ge)),e[0]=t.variables,e[1]=d):d=e[1],m=d;const b=m,[f,w]=u.useState(b);let p,h;e[2]!==t.variableInputs?(h=Object.fromEntries(Object.entries(t.variableInputs).map(Qe)),e[2]=t.variableInputs,e[3]=h):h=e[3],p=h;const C=p;let S,y;e[4]!==b?(S=()=>{w(b)},y=[b],e[4]=b,e[5]=S,e[6]=y):(S=e[5],y=e[6]),u.useEffect(S,y);let O;e[7]===Symbol.for("react.memo_cache_sentinel")?(O=(E,j)=>{w(s=>({...s,[E]:j}))},e[7]=O):O=e[7];const N=O;let A;e[8]!==o||e[9]!==l||e[10]!==f?(A=()=>{o(l,f)},e[8]=o,e[9]=l,e[10]=f,e[11]=A):A=e[11];const $=A;let D;e[12]!==l?(D=n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Configure arguments for ",n.jsx("span",{className:"font-semibold",children:l}),"."]}),e[12]=l,e[13]=D):D=e[13];let g;if(e[14]!==C||e[15]!==t.variableInputs||e[16]!==t.variables||e[17]!==f){let E;e[19]!==C||e[20]!==t.variableInputs||e[21]!==f?(E=j=>{const[s,a]=j,i=t.variableInputs[s],k=C[s];return n.jsxs("div",{className:"rounded border border-border p-2 space-y-1",children:[n.jsx("div",{className:"text-xs font-semibold",children:a.label??s}),n.jsx("div",{className:"text-xs text-muted-foreground",children:a.desc??i?.desc??i?.argType}),k&&n.jsx(Te,{argName:s,breakdown:k,min:i?.min,max:i?.max,initialValue:f[s]??a.defaultValue,setOutputValue:N})]},s)},e[19]=C,e[20]=t.variableInputs,e[21]=f,e[22]=E):E=e[22],g=Object.entries(t.variables).map(E),e[14]=C,e[15]=t.variableInputs,e[16]=t.variables,e[17]=f,e[18]=g}else g=e[18];let v;e[23]!==g?(v=n.jsx("div",{className:"space-y-2 max-h-[50vh] overflow-auto pr-1",children:g}),e[23]=g,e[24]=v):v=e[24];let T;e[25]!==$?(T=n.jsx("div",{className:"flex gap-2 justify-end",children:n.jsx(G,{size:"sm",onClick:$,children:"Apply"})}),e[25]=$,e[26]=T):T=e[26];let R;return e[27]!==v||e[28]!==T||e[29]!==D?(R=n.jsxs("div",{className:"space-y-3",children:[D,v,T]}),e[27]=v,e[28]=T,e[29]=D,e[30]=R):R=e[30],R}function Qe(c){const[e,l]=c;return[e,Ae(ie,l.argType)]}function Ge(c){const[e,l]=c;return[e,l.defaultValue]}function Ye(c){return Array.isArray(c)?[c[0],c[1]]:[c,null]}function bt(){const c=u.useMemo(()=>he(),[]),[e]=ee(ye(c)??"DBNation"),[l]=ee(je(c,e)),[t]=ee((function(){const h=I[e],C=Object.keys(h?.columns??{})[0],S=C?h?.columns[C]?.value:void 0;return ke(c)??new Map((S??["{id}"]).map(y=>Array.isArray(y)?[y[0],y[1]]:[y,null]))})()),o=I[e],m=Object.keys(o?.columns??{})[0],d=m?o?.columns[m]?.columnRenderers:void 0,[b]=ee(we(c)??(m?o?.columns[m]?.sort:void 0)),f=u.useRef(null),w=u.useCallback(()=>{const h=f.current,C=h?.getColumnRenderers()??d;return{type:h?.getType()??e,selection:h?.getSelection()??l,columns:h?.getColumns()??t,sort:h?.getSort()??b,columnRenderers:C}},[f,e,l,t,b,d]),p=u.useMemo(()=>n.jsx("div",{className:"themeDiv p-2 mt-2",children:n.jsx(Fe,{getTableProps:w,load:!1})}),[w]);return n.jsxs(n.Fragment,{children:[n.jsx(De,{ref:f,defType:e,defSelection:l,defColumns:t,defSort:b}),p]})}export{bt as default};
