import{c as P,r as G,j as a,b as Y,R as Q,L as q}from"./index-Ci-lVsFi.js";import{T as X,L as Z,q as $,r as ee,C as U}from"./queries-l4D1Q0nU.js";import{C as te,c as r}from"./command-utils-BU29VnaS.js";import{B as H}from"./button-CWqPuK0O.js";import{C as ae,n as ie}from"./table_util-BA5kOBg_.js";import{T as se}from"./timestamp-DM9T4LEl.js";import{StaticViewGraph as h}from"./view_graph-CWwaQc7P.js";import{ViewCommand as u}from"./view_command-BChO2lqc.js";import{a as ne}from"./DialogContext-ByDpcWnk.js";import{E as le}from"./bulkwrapper-CcS8ktbB.js";import re from"./chevron-up-MD7nKQDD.js";import de from"./chevron-down-Bf66fNBy.js";import"./command-meta-J_rOZp3J.js";import"./edit_graph-BCtmqHgv.js";import"./SimpleChart-B07JoOv1.js";import"./dropdown-menu-DLcaEqVB.js";import"./theme-provider-CM04Ee5i.js";import"./apiform-DSBEjPNR.js";import"./StateUtil-BG53k1sy.js";import"./CommandComponent-CIm2wK6D.js";import"./input-QGQmWr9A.js";import"./traditional-BV6Ghr04.js";import"./index-BdYlohoO.js";import"./CmdList-Dgv4Dhv4.js";import"./index.module-Cm1UP7MU.js";import"./x-BXcCGRVm.js";import"./createLucideIcon-BbdX0qUR.js";import"./useSuspenseQuery-C2wurJin.js";function oe(e){return`https://politicsandwar.com/${e}`}const ce=e=>{const t=P.c(37),{id:n,label:l,value:p,expandedContent:v,buttons:m,className:b,isEven:s}=e,i=b===void 0?"":b,j=s===void 0?!1:s,[d,g]=G.useState(!1),[f,D]=G.useState(!1);let N;t[0]!==f||t[1]!==d?(N=()=>{!d&&!f&&D(!0),g(!d)},t[0]=f,t[1]=d,t[2]=N):N=t[2];const F=N;let W;W=`divide-x divide-primary/5 ${j?"bg-primary/5":""} ${i}`;const E=W,z=!!v;let R;e:{if(!z){R=null;break e}let o;t[3]!==p?(o=a.jsx("span",{children:p}),t[3]=p,t[4]=o):o=t[4];let c;t[5]!==d?(c=d?a.jsx(re,{size:16}):a.jsx(de,{size:16}),t[5]=d,t[6]=c):c=t[6];let x;t[7]!==o||t[8]!==c||t[9]!==F?(x=a.jsxs(H,{variant:"outline",size:"sm",className:"flex items-center gap-2 p-2",onClick:F,children:[o,c]}),t[7]=o,t[8]=c,t[9]=F,t[10]=x):x=t[10],R=x}const K=R;let M;e:{if(!d){M=null;break e}const o=`expanded-${n}`,c=j?"bg-primary/5":"",x=f&&v;let y;t[11]!==x?(y=a.jsx("td",{colSpan:2,className:"p-0",children:a.jsx("div",{className:"p-3 border-t border-primary/10 animate-in fade-in duration-200",children:x})}),t[11]=x,t[12]=y):y=t[12];let S;t[13]!==y||t[14]!==o||t[15]!==c?(S=a.jsx("tr",{className:c,children:y},o),t[13]=y,t[14]=o,t[15]=c,t[16]=S):S=t[16],M=S}const V=M,w=`row-${n}`;let C;t[17]!==l?(C=l&&a.jsx("td",{className:"p-1 min-w-fit whitespace-nowrap font-medium text-right pr-3",children:l}),t[17]=l,t[18]=C):C=t[18];const B=l?1:2,I=z?K:p;let A;t[19]!==I?(A=a.jsx("div",{children:I}),t[19]=I,t[20]=A):A=t[20];let k;t[21]!==m?(k=m&&a.jsx("div",{className:"",children:m}),t[21]=m,t[22]=k):k=t[22];let O;t[23]!==A||t[24]!==k?(O=a.jsxs("div",{className:"flex",children:[A,k]}),t[23]=A,t[24]=k,t[25]=O):O=t[25];let _;t[26]!==O||t[27]!==B?(_=a.jsx("td",{className:"p-1 w-full",colSpan:B,children:O}),t[26]=O,t[27]=B,t[28]=_):_=t[28];let T;t[29]!==E||t[30]!==_||t[31]!==w||t[32]!==C?(T=a.jsxs("tr",{className:E,children:[C,_]},w),t[29]=E,t[30]=_,t[31]=w,t[32]=C,t[33]=T):T=t[33];let L;return t[34]!==V||t[35]!==T?(L=a.jsxs(a.Fragment,{children:[T,V]}),t[34]=V,t[35]=T,t[36]=L):L=t[36],L},J=te.placeholders("DBAlliance").aliased().add({cmd:"getname",alias:"name"}).add({cmd:"getid",alias:"id"}).add({cmd:"getrank",alias:"rank"}).add({cmd:"getacronym",alias:"acronym"}).add({cmd:"getflag",alias:"flag"}).add({cmd:"getforum_link",alias:"forumLink"}).add({cmd:"getdiscord_link",alias:"discordLink"}).add({cmd:"getwiki_link",alias:"wikiLink"}).add({cmd:"getdatecreated",alias:"dateCreated"}).add({cmd:"getcolor",alias:"color"}).add({cmd:"getscore",alias:"score"}).add({cmd:"getestimatedstockpilevalue",alias:"stockpileValue"}).add({cmd:"getestimatedstockpile",alias:"stockpile"}).add({cmd:"getlootvalue",args:{score:"1"},alias:"lootValue"}).add({cmd:"getrevenueconverted",alias:"revenue"}).add({cmd:"getcostconverted",alias:"cost"}).add({cmd:"countmembers",alias:"memberCount"}).add({cmd:"countnations",args:{filter:"#position=1"},alias:"applicantCount"}).add({cmd:"countnations",args:{filter:"#isTaxable"},alias:"taxableCount"}).add({cmd:"getnumtreasures",alias:"treasures"}).add({cmd:"countnations",args:{filter:"#color=gray,#vm_turns=0"},alias:"grayCount"}).add({cmd:"countnations",args:{filter:"#color=gray,#vm_turns=0,#active_m<7200"},alias:"activeGrayCount"}).add({cmd:"countnations",args:{filter:"#cities<10,#FreeOffensiveSlots>0,(#color!=beige|#isblockaded=0)"},alias:"c10WithoutRaids"}).add({cmd:"getcities",alias:"cities"}).add({cmd:"getaverage",args:{attribute:"avgland",filter:"#position>1,#vm_turns=0"},alias:"land_avg"}).add({cmd:"getaverage",args:{attribute:"avg_infra",filter:"#position>1,#vm_turns=0"},alias:"infra_avg"}).add({cmd:"gettotal",args:{attribute:"cityvalue",filter:"#position>1,#vm_turns=0"},alias:"cityValue"}),me=[{label:null,value:e=>a.jsxs("div",{className:"flex items-center space-x-2",children:[e.flag&&a.jsx("img",{src:e.flag,alt:"Alliance flag",className:"w-16 h-10"}),a.jsxs(q,{className:"text-2xl font-bolt flex items-center",to:oe(`alliance/id=${e.id}`),children:[e.name," ",a.jsx(Z,{name:"ExternalLink"})]}),e.acronym&&a.jsxs("span",{className:"text-sm text-gray-500",children:["(",e.acronym,")"]})]})},{label:null,buttons:[{text:()=>"Forum",path:e=>e.forumLink,condition:e=>!!e.forumLink},{text:()=>"Discord",path:e=>e.discordLink,condition:e=>!!e.discordLink},{text:()=>"Wiki",path:e=>e.wikiLink,condition:e=>!!e.wikiLink},{text:e=>`${e.memberCount} Members`,path:e=>`/nations/AA:${e.id},#position>1`,condition:e=>e.memberCount>0},{text:e=>`${e.taxableCount} Taxable`,path:e=>`/nations/AA:${e.id},#isTaxable`,condition:e=>e.taxableCount>0},{text:e=>`${e.applicantCount} Applicants`,path:e=>`/nations/AA:${e.id},#position=1`,condition:e=>e.applicantCount>0}]},{label:"Created",value:e=>a.jsx(se,{millis:e.dateCreated})},{label:"Color",value:e=>a.jsxs("div",{className:"flex items-center",children:[a.jsx(ae,{colorId:e.color}),a.jsx("span",{children:e.color})]})},{label:"Rank",value:e=>a.jsxs(a.Fragment,{children:["#",r(e.rank)]})},{label:"Score",value:e=>a.jsxs(a.Fragment,{children:[r(e.score),"ns"]}),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(u,{command:["alliance","stats","attribute_ranking"],args:{attribute:"{score}",num_results:"5",highlight:e.id+""}}),a.jsx(h,{endpoint:$,args:{metric:"score",alliances:"aa:"+e.id,start:"timestamp:"+e.dateCreated}})]})},{label:"Stockpile Value (Est.)",value:e=>a.jsxs(a.Fragment,{children:["$",r(e.stockpileValue)]}),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(u,{command:["alliance","stats","attribute_ranking"],args:{attribute:"{getestimatedstockpilevalue}",num_results:"5",highlight:e.id+""}}),a.jsx(ne,{text:ie(e.stockpileValue)})]})},{label:"Loot Per Score",value:e=>a.jsxs(a.Fragment,{children:["$",r(e.lootValue)]}),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(u,{command:["alliance","stats","loot_ranking"],args:{time:"30d",num_results:"5",highlight:"AA:"+e.id}}),a.jsx("hr",{}),"Alliance Loot Losses:",a.jsx(u,{command:["stats_war","warcostranking"],args:{timeStart:"30d",type:"ATTACKER_LOSSES",allowedAttacks:"A_LOOT",groupByAlliance:"true",num_results:"5",highlight:"AA:"+e.id}})]})},{label:"Revenue Converted",value:e=>a.jsxs(a.Fragment,{children:["$",r(e.revenue)]}),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(u,{command:["trade","findproducer"],args:{resources:"*",includeNegative:"true",num_results:"5",highlight:e.id+""}}),a.jsx(h,{endpoint:ee,args:{metrics:"revenue",coalition:"aa:"+e.id,start:"timestamp:"+e.dateCreated,end:"0"}}),a.jsx(u,{command:["alliance","revenue"],args:{nations:"AA:"+e.id}})]})},{label:"Alliance Value",value:e=>a.jsxs(a.Fragment,{children:["$",r(e.cost)]}),expandable:!0,expandedContent:e=>a.jsx(a.Fragment,{children:a.jsx(u,{command:["alliance","cost"],args:{nations:"AA:"+e.id}})})},{label:"Gray (non VM)",buttons:[{text:e=>`${e.grayCount} All`,path:e=>`/nations/AA:${e.id},#color=gray,#vm_turns=0`},{text:e=>`${e.activeGrayCount} Active (5d)`,path:e=>`/nations/AA:${e.id},#color=gray,#vm_turns=0,#active_m<7200`}]},{label:"&#91;C10 without raids",buttons:[{text:e=>`${e.c10WithoutRaids} Nations`,path:e=>`/nations/AA:${e.id},#cities<10,#FreeOffensiveSlots>0,(#color!=beige|#isblockaded=0)`}]},{label:"Treasures",value:e=>a.jsxs(a.Fragment,{children:[r(e.treasures)," (",Math.sqrt(e.treasures*4).toFixed(2),"%)"]}),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(u,{command:["alliance","stats","attribute_ranking"],args:{attribute:"{numtreasures}",num_results:"5",highlight:e.id+""}}),a.jsx(h,{endpoint:$,args:{metric:"treasure",alliances:"aa:"+e.id,start:"timestamp:"+e.dateCreated}})]}),buttons:[{text:()=>"View",path:e=>`/treasures/AA:${e.id},#treasure`,condition:e=>e.treasures>=0}]},{label:"Cities",value:e=>a.jsxs(a.Fragment,{children:[r(e.cities)," ($",r(e.cities*4),")"]}),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(u,{command:["alliance","stats","attribute_ranking"],args:{attribute:"{getcities}",num_results:"5",highlight:e.id+""}}),a.jsx(h,{endpoint:$,args:{metric:"city",alliances:"aa:"+e.id,start:"timestamp:"+e.dateCreated}})]}),buttons:[{text:()=>"View",path:e=>`/cities/AA:${e.id},#cities`,condition:e=>e.cities>=0}]},{label:"Infra Avg.",value:e=>r(e.infra_avg),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(h,{endpoint:U,args:{metric:"avg_infra",groupBy:"cities",coalition1:"aa:"+e.id}}),a.jsx(h,{endpoint:$,args:{metric:"infra_avg",alliances:"aa:"+e.id,start:"timestamp:"+e.dateCreated}})]})},{label:"Land Avg.",value:e=>r(e.land_avg),expandable:!0,expandedContent:e=>a.jsxs(a.Fragment,{children:[a.jsx(h,{endpoint:U,args:{metric:"avg_land",groupBy:"cities",coalition1:"aa:"+e.id}}),a.jsx(h,{endpoint:$,args:{metric:"avg_land",alliances:"aa:"+e.id,start:"timestamp:"+e.dateCreated}})]})},{label:"MMR",value:()=>`TODO (non tooltip) unit= | build=
TODO MMR over time + MMR tier graph`},{label:"Soldier %",value:()=>"TODO unit tier graph, unit over time"},{label:"Tank %",value:()=>"TODO unit tier graph, unit over time"},{label:"Aircraft %",value:()=>"TODO unit tier graph, unit over time"},{label:"Ships %",value:()=>"TODO unit tier graph, unit over time"},{label:"Missiles",value:()=>`TODO num missiles (... avg)
TODO MLP tier graph
TODO missiles over time
TODO ranking`},{label:"Nukes",value:()=>`TODO num nukes (... avg)
TODO nuke tier graph
TODO NRF tier graph
TODO nuke over time
TODO ranking`},{label:"Spies",value:()=>`TODO Spy tier graph
TODO avg spies over time`},{label:"Active Wars",value:()=>`TODO Off: 5, Def: 5 (10 Total)
TODO Wars by tier
TODO strength tier graph`}],ue=Q.memo(e=>{const t=P.c(10),{data:n}=e;if(n.cells.length!=2){let s;t[0]!==n?(s=JSON.stringify(n),t[0]=n,t[1]=s):s=t[1];let i;return t[2]!==s?(i=a.jsx(a.Fragment,{children:s}),t[2]=s,t[3]=i):i=t[3],i}let l;if(t[4]!==n.cells[1]){const s=J.createRowAdapter(n.cells[1]);l=me.map((i,j)=>{if(i.condition&&!i.condition(s))return null;const d=i.buttons?a.jsx(a.Fragment,{children:i.buttons.map((g,f)=>{if(g.condition&&!g.condition(s))return null;const D=typeof g.text=="function"?g.text(s):g.text;return a.jsx(H,{className:f>0?"ms-1":"",variant:"outline",size:"sm",asChild:!0,children:a.jsx(q,{to:g.path(s),children:D})},f)})}):null;return a.jsx(ce,{id:j,label:i.label,value:i.value?i.value(s):null,expandedContent:i.expandable&&i.expandedContent?i.expandedContent(s):void 0,buttons:d,isEven:j%2===0},"row-"+j)}),t[4]=n.cells[1],t[5]=l}else l=t[5];const p=l;let v;t[6]===Symbol.for("react.memo_cache_sentinel")?(v=a.jsx("col",{className:"w-auto"}),t[6]=v):v=t[6];let m;t[7]===Symbol.for("react.memo_cache_sentinel")?(m=a.jsxs("colgroup",{children:[v," ",a.jsx("col",{className:"w-full"})," "]}),t[7]=m):m=t[7];let b;return t[8]!==p?(b=a.jsx("div",{className:"rounded-lg border border-primary/20 shadow-sm",children:a.jsxs("table",{className:"display text-xs compact font-mono w-full bg-accent",children:[m,a.jsx("tbody",{className:"divide-y divide-primary/5",children:p})]})}),t[8]=p,t[9]=b):b=t[9],b});function We(){const e=P.c(3),{alliance:t}=Y();let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=J.array(),e[0]=n):n=e[0];let l;return e[1]!==t?(l=a.jsx(le,{endpoint:X,args:{type:"Alliance",selection_str:t,columns:n},children:pe}),e[1]=t,e[2]=l):l=e[2],l}function pe(e){const{data:t}=e;return a.jsx(ue,{data:t})}export{We as default};
