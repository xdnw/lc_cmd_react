import{r as e,j as a,L as t,u as r}from"./index-C3IYMWuf.js";import{L as s,A as n,R as i,i as d}from"./endpoints-C7yNECRQ.js";import{P as l}from"./pagination-BiWfeBTV.js";import{B as o}from"./button-ojqvaOFL.js";import{u as c}from"./copytoclipboard-CYjqdKKr.js";import{E as u}from"./bulkwrapper-Ao1Won9N.js";import{A as m}from"./apiform-BmtKjyBA.js";import"./useSuspenseQuery-C4Rjs_Xf.js";import"./loading-xytKfuKY.js";import"./StateUtil-Qm8zWtOR.js";import"./MarkupRenderer-DGvySKwx.js";import"./SimpleChart-CMaeCEzH.js";import"./theme-provider-CsIAtXtu.js";import"./input-Bbx_s9Yh.js";import"./table_util-BvEisIsm.js";import"./useQuery-DRxnS7Xn.js";function p(){const[r,i]=e.useState(1),d=e.useRef(null),c=e.useCallback((e=>a.jsx("tr",{children:a.jsxs("td",{className:"h-6 relative px-1 break-normal text-sm text-gray-900 dark:text-gray-200 "+(e.active?"font-bold":"text-black"),children:[a.jsx(t,{className:"underline-offset-4 hover:underline active:text-primary/80",to:`/announcement/${e.id}`,children:e.title}),e.active?a.jsx(j,{announcementId:e.id,title:e.title}):a.jsx(h,{announcementId:e.id,title:e.title})]})})),[]),m=e.useCallback((({children:e})=>a.jsxs("table",{className:"min-w-full divide-y",children:[a.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:a.jsx("tr",{children:a.jsx("th",{className:"px-1 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Title"})})}),a.jsx("tbody",{className:"bg-white divide-y divide-solid dark:bg-gray-900",children:e})]})),[]);return a.jsxs(a.Fragment,{children:[a.jsx(o,{variant:"outline",size:"sm",asChild:!0,children:a.jsxs(t,{to:"/guild_member",children:[a.jsx(s,{name:"ChevronLeft",className:"h-4 w-4"}),"Back"]})}),a.jsx(u,{endpoint:n,args:{read:"true"},children:({data:e})=>(null===d.current&&(d.current=e.values),0===d.current.length?a.jsx("div",{children:"No announcements"}):a.jsx(l,{items:d.current??[],render:c,parent:m,perPage:4,currentPage:r,onPageChange:i}))})]})}function j({announcementId:t,title:s}){const{showDialog:d}=c(),l=r(),o=e.useCallback((e=>{d("Marked as read",a.jsxs(a.Fragment,{children:["Marked ",s," as read"]})),l.setQueryData([n.endpoint.name,{read:"true"}],(e=>{const a=e.clone();return a.data&&(a.data=a.data.map((e=>e.id===t?{...e,active:!1}:e))),a}))}),[d,s,t,l]);return a.jsx(m,{endpoint:i,default_values:{ann_id:t+""},label:"Mark Read",classes:"absolute top-0 right-0 h-5 mt-0.5 border-0",handle_response:o})}function h({announcementId:t,title:s}){const{showDialog:i}=c(),l=r(),o=e.useCallback((e=>{i("Marked as unread",a.jsxs(a.Fragment,{children:["Marked ",s," as unread"]})),l.setQueryData([n.endpoint.name,{read:"true"}],(e=>{const a=e.clone();return a.data&&(a.data=a.data.map((e=>e.id===t?{...e,active:!0}:e))),a}))}),[i,s,t,l]);return a.jsx(m,{endpoint:d,default_values:{ann_id:t+""},label:"Mark Unread",classes:"absolute top-0 right-0 h-5 mt-0.5 border-0",handle_response:o})}export{j as Read,h as Unread,p as default};
