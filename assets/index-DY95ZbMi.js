import{r as e,j as a,L as t,u as r}from"./index-C3E2-SUH.js";import{L as n,A as s,R as i,i as d}from"./queries-BuM6HYrb.js";import{P as l}from"./pagination-Dtcd6cUf.js";import{B as o}from"./button-DCZsNPnk.js";import{u as m}from"./DialogContext-BJx4vabV.js";import{E as c}from"./bulkwrapper-CffFvLGh.js";import{A as u}from"./apiform-BYdO01Da.js";import"./useSuspenseQuery-DiLOpIi1.js";import"./loading-CI11-4Uh.js";import"./StateUtil-CGhFEjjS.js";import"./CommandComponent-H-FPWJ9S.js";import"./input-CXVReF6E.js";import"./SimpleChart-OHRi1aHe.js";import"./theme-provider-CY-pBUqn.js";import"./table_util-C8W_dWTS.js";function p(){const[r,i]=e.useState(1),d=e.useRef(null),m=e.useCallback((e=>a.jsx("tr",{children:a.jsxs("td",{className:"h-6 relative px-1 break-normal text-sm text-gray-900 dark:text-gray-200 "+(e.active?"font-bold":"text-black"),children:[a.jsx(t,{className:"underline-offset-4 hover:underline active:text-primary/80",to:`/announcement/${e.id}`,children:e.title}),e.active?a.jsx(j,{announcementId:e.id,title:e.title}):a.jsx(h,{announcementId:e.id,title:e.title})]})})),[]),u=e.useCallback((({children:e})=>a.jsxs("table",{className:"min-w-full divide-y",children:[a.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:a.jsx("tr",{children:a.jsx("th",{className:"px-1 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Title"})})}),a.jsx("tbody",{className:"bg-white divide-y divide-solid dark:bg-gray-900",children:e})]})),[]);return a.jsxs(a.Fragment,{children:[a.jsx(o,{variant:"outline",size:"sm",asChild:!0,children:a.jsxs(t,{to:"/guild_member",children:[a.jsx(n,{name:"ChevronLeft",className:"h-4 w-4"}),"Back"]})}),a.jsx(c,{endpoint:s,args:{read:"true"},children:({data:e})=>(null===d.current&&(d.current=e.values),0===d.current.length?a.jsx("div",{children:"No announcements"}):a.jsx(l,{items:d.current??[],render:m,parent:u,perPage:4,currentPage:r,onPageChange:i}))})]})}function j({announcementId:t,title:n}){const{showDialog:d}=m(),l=r(),o=e.useCallback((e=>{d("Marked as read",a.jsxs(a.Fragment,{children:["Marked ",n," as read"]})),l.setQueryData([s.endpoint.name,{read:"true"}],(e=>{const a=e.clone();return a.data&&(a.data=a.data.map((e=>e.id===t?{...e,active:!1}:e))),a}))}),[d,n,t,l]);return a.jsx(u,{endpoint:i,default_values:{ann_id:t+""},label:"Mark Read",classes:"absolute top-0 right-0 h-5 mt-0.5 border-0",handle_response:o})}function h({announcementId:t,title:n}){const{showDialog:i}=m(),l=r(),o=e.useCallback((e=>{i("Marked as unread",a.jsxs(a.Fragment,{children:["Marked ",n," as unread"]})),l.setQueryData([s.endpoint.name,{read:"true"}],(e=>{const a=e.clone();return a.data&&(a.data=a.data.map((e=>e.id===t?{...e,active:!0}:e))),a}))}),[i,n,t,l]);return a.jsx(u,{endpoint:d,default_values:{ann_id:t+""},label:"Mark Unread",classes:"absolute top-0 right-0 h-5 mt-0.5 border-0",handle_response:o})}export{j as Read,h as Unread,p as default};
