import{c as h,r as x,u as g,j as r,L as y}from"./index-CkdKFI98.js";import{L as b,A as f,Q as j,R as k,g as E}from"./queries-ByOb2jVj.js";import{P as R}from"./pagination-fK798PpW.js";import{B as A}from"./button-C_VcwxQ2.js";import{u as v}from"./DialogContext-D_bUabOf.js";import{E as C}from"./bulkwrapper-BIfe5AfD.js";import{A as N}from"./apiform-BIGYvhTG.js";import"./command-utils-CkY5cVJv.js";import"./command-meta-r_ruCnhz.js";import"./useSuspenseQuery-AkitrqQh.js";import"./StateUtil-BKtOCwcq.js";import"./CommandComponent-KxhOFLhp.js";import"./input-CfYBFoRI.js";import"./SimpleChart-C5HyDjux.js";import"./dropdown-menu-BREEIaC2.js";import"./theme-provider-DEyqfEv0.js";import"./table_util-HxaTGot0.js";import"./traditional-BerdgZli.js";function Y(){const t=h.c(4),[e,c]=x.useState(1),i=x.useRef(null),u=w,m=M;let a;t[0]===Symbol.for("react.memo_cache_sentinel")?(a=r.jsx(A,{variant:"outline",size:"sm",asChild:!0,children:r.jsxs(y,{to:"/guild_member",children:[r.jsx(b,{name:"ChevronLeft",className:"h-4 w-4"}),"Back"]})}),t[0]=a):a=t[0];let o;t[1]===Symbol.for("react.memo_cache_sentinel")?(o={read:"true"},t[1]=o):o=t[1];let l;return t[2]!==e?(l=r.jsxs(r.Fragment,{children:[a,r.jsx(C,{endpoint:f,args:o,children:n=>{const{data:d}=n;return i.current===null&&(i.current=d.values),i.current.length===0?r.jsx("div",{children:"No announcements"}):r.jsx(R,{items:i.current??[],render:u,parent:m,perPage:4,currentPage:e,onPageChange:c})}})]}),t[2]=e,t[3]=l):l=t[3],l}function M(t){const{children:e}=t;return r.jsxs("table",{className:"min-w-full divide-y",children:[r.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:r.jsx("tr",{children:r.jsx("th",{className:"px-1 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"Title"})})}),r.jsx("tbody",{className:"bg-white divide-y divide-solid dark:bg-gray-900",children:e})]})}function w(t){return r.jsx("tr",{children:r.jsxs("td",{className:`h-6 relative px-1 break-normal text-sm text-gray-900 dark:text-gray-200 ${t.active?"font-bold":"text-black"}`,children:[r.jsx(y,{className:"underline-offset-4 hover:underline active:text-primary/80",to:`/announcement/${t.id}`,children:t.title}),t.active?r.jsx(I,{announcementId:t.id,title:t.title}):r.jsx(L,{announcementId:t.id,title:t.title})]})})}function I(t){const e=h.c(10),{announcementId:c,title:i}=t,{showDialog:u}=v(),m=g();let a;e[0]!==c||e[1]!==m||e[2]!==u||e[3]!==i?(a=_=>{u("Marked as read",r.jsxs(r.Fragment,{children:["Marked ",i," as read"]})),m.setQueryData([f.endpoint.name,{read:"true"}],s=>s&&s.data&&s.data.values?new j({endpoint:s.endpoint,query:s.query,update_ms:s.update_ms,cache:s.cache,error:s.error,data:{values:s.data.values.map(p=>p.id===c?{...p,active:!1}:p)}}):s)},e[0]=c,e[1]=m,e[2]=u,e[3]=i,e[4]=a):a=e[4];const o=a,l=c+"";let n;e[5]!==l?(n={ann_id:l},e[5]=l,e[6]=n):n=e[6];let d;return e[7]!==o||e[8]!==n?(d=r.jsx(N,{endpoint:k,default_values:n,label:"Mark Read",classes:"absolute top-0 right-0 h-5 mt-0.5 border-0",handle_response:o}),e[7]=o,e[8]=n,e[9]=d):d=e[9],d}function L(t){const e=h.c(10),{announcementId:c,title:i}=t,{showDialog:u}=v(),m=g();let a;e[0]!==c||e[1]!==m||e[2]!==u||e[3]!==i?(a=_=>{u("Marked as unread",r.jsxs(r.Fragment,{children:["Marked ",i," as unread"]})),m.setQueryData([f.endpoint.name,{read:"true"}],s=>s&&s.data&&s.data.values?new j({endpoint:s.endpoint,query:s.query,update_ms:s.update_ms,cache:s.cache,error:s.error,data:{values:s.data.values.map(p=>p.id===c?{...p,active:!0}:p)}}):s)},e[0]=c,e[1]=m,e[2]=u,e[3]=i,e[4]=a):a=e[4];const o=a,l=c+"";let n;e[5]!==l?(n={ann_id:l},e[5]=l,e[6]=n):n=e[6];let d;return e[7]!==o||e[8]!==n?(d=r.jsx(N,{endpoint:E,default_values:n,label:"Mark Unread",classes:"absolute top-0 right-0 h-5 mt-0.5 border-0",handle_response:o}),e[7]=o,e[8]=n,e[9]=d):d=e[9],d}export{I as Read,L as Unread,Y as default};
